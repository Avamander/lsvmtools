include ../../../defs.mak

##==============================================================================
##
## TARGET
##
##==============================================================================

TARGET=$(LIBDIR)/libcryptolinux.a

##==============================================================================
##
## OPENSSLSRCDIR
##
##==============================================================================

OPENSSLSRCDIR=$(OPENSSLPACKAGE)

##==============================================================================
##
## all:
##
##==============================================================================

$(TARGET):
	$(MAKE) unpack
	$(MAKE) configure
	$(MAKE) build

##==============================================================================
##
## build
##
##==============================================================================

build:
	$(MAKE) -C $(OPENSSLSRCDIR) DIRS=crypto CC="gcc $(LINUX_CFLAGS)"
	mkdir -p $(LIBDIR)
	cp $(OPENSSLSRCDIR)/libcrypto.a $(TARGET)

##==============================================================================
##
## unpack
##
##==============================================================================

unpack:
	rm -rf $(OPENSSLSRCDIR)
	tar zxvf ../$(OPENSSLSRCDIR).tar.gz

##==============================================================================
##
## configure:
##
##==============================================================================

configure:
	( cd $(OPENSSLSRCDIR); ./config )

##==============================================================================
##
## clean:
##
##==============================================================================

clean:
	- @ $(MAKE) -C $(OPENSSLSRCDIR) clean 2> /dev/null > /dev/null
	- @ rm -f $(TARGET)

distclean:
	$(MAKE) -s clean
	rm -rf $(OPENSSLSRCDIR)

install:
